ğŸ¤” Strategic Review (ê¸°ì¡´ 3ì•ˆ ë¹„êµ)
ì•ˆ	í•µì‹¬âŒ—	ì¥ì 	í•œê³„
Gem_01	ActionChains+ìƒì„¸ XPath	ì¦‰ì‹œ ë™ì‘ ê°€ëŠ¥Â·ë””ë²„ê¹… í¸ì˜	XPath ê¸¸ê³  UI ë³€ê²½ ì·¨ì•½
Codex_01	ê°„ê²° CSS Selector+í—¬í¼	ìœ ì§€ë³´ìˆ˜ ì‰¬ì›€	ì‹¤ì œ DOM ë§ì¶¤ ë³´ì • í•„ìš”
O3_01	ëŒ€ì•ˆ ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤ ì •ë¦¬	ì „ëµí­ ë„“ìŒ	êµ¬í˜„ ìŠ¤í… ìˆ˜ì¤€

ê²°ë¡  : Gem_01 êµ¬í˜„ì„ ë¼ˆëŒ€ë¡œ í•˜ë˜, Codexì˜ ê°„ê²° Selector ì•„ì´ë””ì–´Â·O3ì˜ JS fallbackì„ í•©ì¹œ Hybrid V1 ì ìš©.

ğŸ“ Hybrid V1 êµ¬í˜„ í”Œëœ
1. ë¶ˆì•ˆì • êµ¬ ì½”ë“œ ì œê±°
generate_report_html ì¤‘ ë‚ ì§œ ì…ë ¥ êµ¬ê°„ì„ ì§ì ‘ ì…ë ¥ìœ¼ë¡œ êµì²´

_select_date_from_calendar í•¨ìˆ˜ ì „ì²´ ì‚­ì œ (ì˜ì¡´ ë¼ì¸ ë„ ëª¨ë‘ ì œê±°)

2. ì‹ ê·œ í—¬í¼ _input_date_directly
python
ë³µì‚¬
í¸ì§‘
def _input_date_directly(self, date_str: str, idx: int):
    """
    idx 0: ì‹œì‘ / 1: ì¢…ë£Œ â€” Report Reference Date segmentì— ì§ì ‘ í…ìŠ¤íŠ¸ ì…ë ¥
    """
    dt = datetime.strptime(date_str, "%Y-%m-%d")
    seg_css = (
        "[contenteditable='true'][aria-label*='ì‹œì‘ì¼']"
        if idx == 0 else
        "[contenteditable='true'][aria-label*='ì¢…ë£Œì¼']"
    )
    fields = WebDriverWait(self.driver, 10).until(
        EC.visibility_of_all_elements_located((By.CSS_SELECTOR, seg_css))
    )
    # í•„ë“œê°€ í™”ë©´ ì¢Œâ†’ìš° ìˆœìœ¼ë¡œ ì •ë ¬ë¼ ìˆì§€ ì•Šìœ¼ë©´ x ì¢Œí‘œë¡œ ì •ë ¬
    fields.sort(key=lambda e: e.location['x'])
    for elm, txt in zip(fields, (dt.strftime("%m"), dt.strftime("%d"), dt.strftime("%Y"))):
        elm.click(); time.sleep(0.05)
        elm.send_keys(Keys.CONTROL, 'a', Keys.DELETE); time.sleep(0.05)
        elm.send_keys(txt); elm.send_keys(Keys.TAB)
    # ğŸ’¡ JS ë™ê¸°í™” ë°±ì—… (í•„ìš” ì‹œ í™œì„±)
    hidden_script = """
      const inp=document.querySelector('input[name="ref-date-%s-hidden"]');
      if(inp){inp.value='%s';inp.dispatchEvent(new Event('input',{bubbles:true}));}
    """ % ('start' if idx==0 else 'end', date_str)
    self.driver.execute_script(hidden_script)
Selector ì „ëµ:

aria-label*='ì‹œì‘ì¼|ì¢…ë£Œì¼' â†’ ë‹¤êµ­ì–´ ë³€ê²½ì— ìµœì†Œí•œìœ¼ë¡œ ì˜ì¡´

location['x'] ì •ë ¬ â†’ ì›”Â·ì¼Â·ë…„ segment ìˆœì„œê°€ DOM ìƒ ë’¤ë°”ë€Œì–´ë„ ì •ë ¬

3. generate_report_html ë‚´ í˜¸ì¶œë¶€
python
ë³µì‚¬
í¸ì§‘
self._input_date_directly(ref_date_start_str, 0)
self._input_date_directly(ref_date_end_str, 1)
print("Report Reference Date ì…ë ¥ ì™„ë£Œ.")
4. Fail-safe JS API (ì „ë©´ í›„ë³´)
python
ë³µì‚¬
í¸ì§‘
# date-picker ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ window.txDatePicker ë¼ëŠ” ì „ì—­ì— ì§‘ì¤‘ë¼ ìˆì„ ë•Œ
self.driver.execute_script(
    "window.txDatePicker?.setRange(arguments[0], arguments[1]);",
    ref_date_start_str, ref_date_end_str
)
UI ë³€ê²½ìœ¼ë¡œ contenteditable ì„¸ê·¸ë¨¼íŠ¸ê°€ ì‚¬ë¼ì§ˆ ê²½ìš° ì¦‰ì‹œ T-switch.

5. í…ŒìŠ¤íŠ¸ ì‹œí€€ìŠ¤
ë‹¨ì¼ ë³´ê³ ì„œ ëª¨ë“œë¡œ ì‹¤í–‰ â†’ ë‘ ë‚ ì§œ ì„¸ê·¸ë¨¼íŠ¸ í…ìŠ¤íŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ì±„ì›Œì§€ëŠ”ì§€ ëˆˆìœ¼ë¡œ í™•ì¸

F12 ì½˜ì†” document.querySelectorAll("input[type=hidden][name^='ref-date']").forEach(i=>console.log(i.name,i.value))

ì •ìƒ ìƒì„± í›„ ê³¼ê±°Â·ë¯¸ë˜ ë‚ ì§œ ìƒ˜í”Œ êµì°¨ í…ŒìŠ¤íŠ¸ (ìœ¤ë…„ 2/29 í¬í•¨).

6. ì½”ë“œ íŒ¨ì¹˜ (Unix diff í˜•íƒœ ë°œì·Œ)
diff
ë³µì‚¬
í¸ì§‘
-class FenokReportGenerator:
-    ...
-    def _select_date_from_calendar(self, ...):
-        ...
+# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
+# NEW: direct date input helper
+    def _input_date_directly(self, date_str: str, idx: int):
+        # (ìœ„ ì½”ë“œ ë³¸ë¬¸)
+
 # in generate_report_html
-            start_date_calendar_button_xpath = ...
-            self._select_date_from_calendar(ref_date_start_str, start_date_calendar_button_xpath)
-            end_date_calendar_button_xpath   = ...
-            self._select_date_from_calendar(ref_date_end_str, end_date_calendar_button_xpath)
+            self._input_date_directly(ref_date_start_str, 0)
+            self._input_date_directly(ref_date_end_str,   1)
7. ìœ„í—˜ ë° ëŒ€ì‘
ë¦¬ìŠ¤í¬	ëŒ€ì‘
DOM êµ¬ì¡° ëŒ€í­ ë³€ê²½	seg_css ì‹¤íŒ¨ â†’ try/except í›„ JS fallback ì¦‰ì‹œ í˜¸ì¶œ
ë‹¤êµ­ì–´ aria-label ë³€í™”	`*='start'
ì…ë ¥ í›„ Generate ë²„íŠ¼ disable ì§€ì†	ìˆ¨ì€ input ë™ê¸°í™” JS í™œì„± ë° blur() event ì¶”ê°€
Selenium send_keys race	0.05 sec ì§€ì—°Â·WebDriverWait element_to_be_clickable ë³´ê°•

ë‹¤ìŒ ë‹¨ê³„

ìœ„ Diffë¥¼ main_generator.pyì— ë°˜ì˜

install_dependencies.bat ì´ë¯¸ êµ¬ë¹„ â†’ ë³€ë™ ì—†ìŒ

ë‹¨ê±´ í…ŒìŠ¤íŠ¸ â†’ í†µê³¼ ì‹œ ë°°ì¹˜ ìë™í™” 5Ã—2 íšŒì°¨ ì¬ê°€ë™

ë¬¸ì œì—†ì´ ë™ì‘í•˜ë©´ calendar ë£¨í‹´ê³¼ ê´€ë ¨ ë¶ˆí•„ìš” ì½”ë“œÂ·ë¡œê·¸ë¥¼ ì •ë¦¬í•´ ìµœì¢… PR ì˜¬ë¦½ë‹ˆë‹¤.
ì¶”ê°€ ìš”ì²­ì´ ìˆìœ¼ì‹œë©´ ì•Œë ¤ì£¼ì„¸ìš”.